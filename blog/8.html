<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-01-23 Mon 23:30 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SICP. 1.2.6</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="./style.css"/>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">SICP. 1.2.6
<br />
<span class="subtitle">2023-01-23 Mon</span>
</h1>
<p>
Here is one way to find whether a number is prime:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">smallest-divisor</span> (n)
  (find-divisor n 2))

(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">find-divisor</span> (n test-divisor)
  (<span style="color: #b9ca4a;">cond</span> ((&gt; (square test-divisor) n)
         n)
        ((dividesp test-divisor n)
         test-divisor)
        (t (find-divisor
            n
            (+ test-divisor 1)))))

(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">dividesp</span> (a b)
  (= (% b a ) 0))

(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">primep</span> (n)
  (= n (smallest-divisor n)))
</pre>
</div>

<p>
In the worst case scenario we have to call test-divisor \(\sqrt{n}\)
times. So, the order of growth is \(\Theta (\sqrt{n})\).
</p>

<p>
The authors also present a \(\Theta (log(n))\) algorithm to tests
primality. This algorithm is based on the so-called Fermat's Little
Theorem:
</p>

<ul class="org-ul">
<li><b>Fermat's Little Theorem</b>: If \(n\) is a prime number and \(a\) is any
positive integer less than n, then \(a\) raised ot the \(n^{th}\) power
is congruent to \(a\) modulo \(n\).</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">expmod</span> (base exp m)
  (<span style="color: #b9ca4a;">cond</span> ((= exp 0) 1)
        ((evenp exp)
         (%
          (square (expmod base (/ exp 2) m))
          m))
        (t
         (%
          (* base (expmod base (- exp 1) m))
          m))))

(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">try-it</span> (a n)
  (= (expmod a n n) a))

(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">fermat-test</span> (n)
  (try-it (+ 1 (random (- n 1))) n))

(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">fast-primep</span> (n times)
  (<span style="color: #b9ca4a;">cond</span> ((= times 0) t)
        ((fermat-test n)
         (fast-primep n (- times 1)))
        (t nil)))

(<span style="color: #b9ca4a;">defun</span> <span style="color: #e78c45;">evenp</span> (n)
  (= (% n 2) 0)
</pre>
</div>

<div id="outline-container-org1353db5" class="outline-2">
<h2 id="org1353db5">Exercise 1.21</h2>
<div class="outline-text-2" id="text-org1353db5">
<p>
Exercise:
</p>
<blockquote>
<p>
Use the smallest-divisor procedure to find the smallest divisor of
each of the following numbers: 199, 1999, 19999.
</p>
</blockquote>

<p>
Answer:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(smallest-divisor 199)   <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">=&gt; 199</span>
</pre>
</div>

<p>
This is the series of procedure calls:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(smallest-divisor 199)
(find-divisor 199 2)
(<span style="color: #b9ca4a;">cond</span> ((&gt; (square 2) 199)
       199)
      ((dividesp 2 199)
       2)
      (t (find-divisor
          199
          (+ 2 1))))
(find-divisor 199 3)
(find-divisor 199 4)
(find-divisor 199 5)
(find-divisor 199 6)
(find-divisor 199 7)
(find-divisor 199 8)
(find-divisor 199 9)
(find-divisor 199 10)
(find-divisor 199 11)
(find-divisor 199 12)
(find-divisor 199 13)
(find-divisor 199 14)
(find-divisor 199 15)
199
</pre>
</div>


<div class="org-src-container">
<pre class="src src-emacs-lisp">(smallest-divisor 1999)  <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">=&gt; 1999</span>
</pre>
</div>

<p>
This is the series of procedure calls:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(smallest-divisor 1999)
(find-divisor 1999 2)

(<span style="color: #b9ca4a;">cond</span> ((&gt; (square 2) 1999)
       1999)
      ((dividesp 2 1999)
       2)
      (t (find-divisor
             1999
             (+ 2 1))))

(find-divisor 1999 3)

(find-divisor 1999 4)

<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">...</span>

(find-divisor 1999 45)

1999
</pre>
</div>



<div class="org-src-container">
<pre class="src src-emacs-lisp">(smallest-divisor 19999) <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">=&gt; 7</span>
</pre>
</div>
<p>
This is the series of procedure calls:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(smallest-divisor 19999)

(find-divisor 19999 2)

(find-divisor 19999 3)

(find-divisor 19999 4)

(find-divisor 19999 5)

(find-divisor 19999 6)

(find-divisor 19999 7)
7
</pre>
</div>

<div style="text-align: center;">
<a href="https://pietroiusti.github.io/blog/posts.html">←</a>
</div>
</div>
</div>

<div id="outline-container-org02427a4" class="outline-2">
<h2 id="org02427a4">Exercise 1.22</h2>
<div class="outline-text-2" id="text-org02427a4">
<blockquote>
<p>
Most Lisp implementations include a primitive called runtime that
returns an integer that specifies the amount of time the system has
been running (measured, for example, in microseconds). The following
timed-prime-test procedure, when called with an integer n, prints n
and checks to see if n is prime. If n is prime, the procedure prints
three asterisks followed by the amount of time used in performing the
test.
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">timed-prime-test</span> n)
  (newline)
  (display n)
  (start-prime-test n (runtime)))
(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">start-prime-test</span> n start-time)
  (<span style="color: #b9ca4a;">if</span> (prime? n)
      (report-prime (- (runtime)
                       start-time))))
(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">report-prime</span> elapsed-time)
  (display <span style="color: #70c0b1;">" *** "</span>)
  (display elapsed-time))
</pre>
</div>

<p>
Using this procedure, write a procedure search-for-primes that checks
the primality of consecutive odd integers in a specified range. Use
your procedure to find the three smallest primes larger than 1000;
larger than 10,000; larger than 100,000; larger than 1,000,000. Note
the time needed to test each prime. Since the testing algorithm has
order of growth of \(\theta (\sqrt{n})\), you should expect that testing
for primes around 10,000 should take about \(\sqrt{10}\) times as long
as testing for primes around 1000. Do your timing data bear this out?
How well do the data for 100,000 and 1,000,000 support the \(\theta
(\sqrt{n})\) prediction? Is your result compatible with the notion that
programs on your machine run in time proportional to the number of
steps required for the computation?
</p>
</blockquote>

<p>
Answer:
</p>

<p>
For this exercise I'm using (Dr)Racket, which provides a version of
Scheme specifically modified in order to be used for SICP's code
(useful here in that it provides <code>runtime</code>.).
</p>

<div class="org-src-container">
<pre class="src src-scheme">#lang sicp
(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">square</span> x)
  (* x x))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">smallest-divisor</span> n)
  (find-divisor n 2))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">find-divisor</span> n test-divisor)
  (<span style="color: #b9ca4a;">cond</span> ((&gt; (square test-divisor) n)
         n)
        ((divides? test-divisor n)
         test-divisor)
        (<span style="color: #b9ca4a;">else</span> (find-divisor
               n
               (+ test-divisor 1)))))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">divides?</span> a b)
  (= (remainder b a) 0))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">prime?</span> n)
  (= n (smallest-divisor n)))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">timed-prime-test</span> n)
  (newline)
  (display n)
  (start-prime-test n (runtime)))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">start-prime-test</span> n start-time)
  (<span style="color: #b9ca4a;">if</span> (prime? n)
      (report-prime (- (runtime)
                       start-time))))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">report-prime</span> elapsed-time)
  (display <span style="color: #70c0b1;">" *** "</span>)
  (display elapsed-time))

(timed-prime-test 199) <span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">199 *** 6</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">search-for-primes</span> begin end)
  (<span style="color: #b9ca4a;">cond</span> ((&lt; begin end)
         (timed-prime-test begin)
         (search-for-primes (+ 2 begin) end))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-scheme">(search-for-primes 1001 1021)
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1001</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1003</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1005</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1007</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1009 *** 5</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1011</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1013 *** 4</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1015</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1017</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1019 *** 3</span>

(search-for-primes 10001 10050)
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10001</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10003</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10005</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10007 *** 12</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10009 *** 9</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10011</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10013</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10015</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10017</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10019</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10021</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10023</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10025</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10027</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10029</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10031</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10033</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10035</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10037 *** 8</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10039 *** 8</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10041</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10043</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10045</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10047</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">10049</span>

(search-for-primes 100001 100050)
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100001</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100003 *** 22</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100005</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100007</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100009</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100011</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100013</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100015</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100017</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100019 *** 21</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100021</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100023</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100025</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100027</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100029</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100031</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100033</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100035</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100037</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100039</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100041</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100043 *** 21</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100045</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100047</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">100049 *** 20</span>

(search-for-primes 1000001 1000051)

<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000001</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000003 *** 79</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000005</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000007</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000009</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000011</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000013</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000015</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000017</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000019</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000021</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000023</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000025</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000027</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000029</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000031</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000033 *** 63</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000035</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000037 *** 62</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000039 *** 65</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000041</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000043</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000045</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000047</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">1000049</span>
</pre>
</div>

<p>
I have been told that this exercise (and following ones) might be a
bit out of date, given the advancements in computer hardware
technology. Given the small size of the amounts of time in question,
measurement's accuracy is probably not to be trusted.
</p>

<p>
Let's do some measure nonetheless; using bigger numbers.
</p>

<p>
Computing <code>(timed-prime-test 34888314291653)</code> &#x2014; I've chosen randomly
&#x2014; took 642.775 milliseconds. These should be enough to have an
acceptable accuracy in our benchmarking. Let's start our experiments
from here.
</p>

<p>
Let's find the first three primes starting from 34888314291653.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291653 *** 701102</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291655</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291657</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291659</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291661</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291663</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291665</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291667 *** 895322</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291669</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291671</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291673</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291675</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291677</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291679</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291681</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291683</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291685</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291687</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291689</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291691</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291693</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291695</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291697</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291699</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291701</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291703</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291705</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291707</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291709</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291711</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291713 *** 630255</span>
</pre>
</div>

<p>
Now we multiply 34888314291653 by ten and find the first three primes
starting from there. 34888314291653 times 10 is 348883142916530.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916531</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916533 *** 2027795</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916535</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916537</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916539</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916541</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916543</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916545</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916547</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916549</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916551</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916553</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916555</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916557</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916559</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916561</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916563</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916565</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916567</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916569</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916571</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916573</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916575</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916577</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916579</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916581</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916583</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916585</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916587</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916589</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916591</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916593</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916595</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916597</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916599</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916601</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916603</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916605</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916607</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916609</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916611</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916613 *** 1893341</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916615</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916617</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916619</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916621</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916623</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916625</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916627</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916629</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916631</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916633</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916635</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916637</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916639</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916641</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916643</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916645</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916647</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916649</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916651</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916653</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916655</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916657</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916659</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916661</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916663</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916665</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916667</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916669</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916671</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916673</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916675</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916677</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916679</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916681</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916683</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916685</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916687</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916689</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916691</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916693</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916695</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916697</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916699</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916701</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916703</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916705</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916707</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916709</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916711</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916713</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916715</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916717</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916719</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916721</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916723</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916725</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916727</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916729</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916731</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916733</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916735</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916737</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">348883142916739 *** 1809663</span>
</pre>
</div>

<p>
(* 701102 (sqrt 10)) = 2217079.192099371. With 348883142916533 we
took 2027795, so the prediction is roughly correct.
</p>

<p>
Let us now test whether the number we find after (*
10 348883142916530) and those after (* 10 10 348883142916530) fulfill
the prediction too.
</p>

<blockquote>
<p>
3488831429165323 <b>*</b> 5971326
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-scheme">(search-for-primes 3488831429165301 3488831429165401)
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">...</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">3488831429165323 *** 5971326</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">...</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-scheme">(search-for-primes 34888314291653011 34888314291653511)
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">...</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">34888314291653021 *** 16052655</span>
<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">...</span>
</pre>
</div>

<p>
(* 5971326 (sqrt 10)) 18882990.81138261. Again, the prediction seems
roughly correct.
</p>
</div>
</div>

<div id="outline-container-org44f4251" class="outline-2">
<h2 id="org44f4251">Exercise 1.23</h2>
<div class="outline-text-2" id="text-org44f4251">
<blockquote>
<p>
The <code>smallest-divisor</code> procedure shown at the start of this section
does lots of needless testing: After it checks to see if the number is
divisible by 2 there is no point in checking to see if it is divisible
by any larger even numbers. This suggests that the values used for
<code>test-divisor</code> should not be 2, 3, 4, 5, 6, …, but rather 2, 3, 5, 7,
9, …. To implement this change, define a procedure next that returns 3
if its input is equal to 2 and otherwise returns its input
plus 2. Modify the <code>smallest-divisor</code> procedure to use <code>(next
test-divisor)</code> instead of <code>(+ test-divisor 1)</code>. With
<code>timed-prime-test</code> incorporating this modified version of
<code>smallest-divisor</code>, run the test for each of the 12 primes found in
Exercise 1.22. Since this modification halves the number of test
steps, you should expect it to run about twice as fast. Is this
expectation confirmed? If not, what is the observed ratio of the
speeds of the two algorithms, and how do you explain the fact that it
is different from 2?
</p>
</blockquote>

<p>
Answer:
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">smallest-divisor-mod</span> n)
  (find-divisor-mod n 2))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">find-divisor-mod</span> n test-divisor)
  (<span style="color: #b9ca4a;">cond</span> ((&gt; (square test-divisor) n)
         n)
        ((divides? test-divisor n)
         test-divisor)
        (<span style="color: #b9ca4a;">else</span> (find-divisor
               n
               (next test-divisor)))))

<span style="color: #969896; font-style: italic;">;; </span><span style="color: #969896; font-style: italic;">...</span>

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">next</span> n)
  (<span style="color: #b9ca4a;">if</span> (= n 2)
      3
      (+ n 1)))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">prime?-mod</span> n)
  (= n (smallest-divisor-mod n)))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">timed-prime-test-mod</span> n)
  (newline)
  (display n)
  (start-prime-test n (runtime)))

(<span style="color: #b9ca4a;">define</span> (<span style="color: #e78c45;">start-prime-test-mod</span> n start-time)
  (<span style="color: #b9ca4a;">if</span> (prime?-mod n)
      (report-prime (- (runtime)
                       start-time))))
</pre>
</div>

<p>
I haven't observed any relevant difference with the numbers I have
tested. I'm not sure why that is so. One possible explanation is that
the numbers I have tested are too small. Another possible explanation
is that Racket performs some optimizations.
</p>

<div style="text-align: center;">
<a href="https://pietroiusti.github.io/blog/posts.html">←</a>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p>Please, send me an <a href="mailto:giulio.pietroiusti@gmail.com">email</a> if you have any comment.</p> <p>Created with <span class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.2 (<a href="https://orgmode.org">Org</a> mode 9.5.5)</span></p>
</div>
</body>
</html>
